import pandas as pd

# 📂 Διαβάζουμε το αρχείο Excel
df = pd.read_excel("domino_code2_template.xlsx")

# Μετατροπή ημερομηνιών
df["Ημερομηνία Έναρξης"] = pd.to_datetime(df["Ημερομηνία Έναρξης"])
df["Ημερομηνία Λήξης"] = pd.to_datetime(df["Ημερομηνία Λήξης"])

# Επιλογή εργασίας και καθυστέρησης
εργασία_καθυστέρηση = "Απόφαση πελάτη"  # μπορεί να είναι input
καθυστέρηση_ημέρες = 322               # μπορεί να είναι input

# 📌 Συνάρτηση για εύρεση όλων των εξαρτώμενων εργασιών
def βρες_επηρεαζόμενες(εργασία, εξαρτήσεις):
    επηρεαζόμενες = []
    for index, row in εξαρτήσεις.iterrows():
        if row["Εξαρτάται από"] == εργασία:
            επηρεαζόμενες.append(row["Εργασία"])
            επηρεαζόμενες.extend(βρες_επηρεαζόμενες(row["Εργασία"], εξαρτήσεις))
    return επηρεαζόμενες

# Βρίσκουμε όλες τις εργασίες που επηρεάζονται
επηρεαζόμενες_εργασίες = βρες_επηρεαζόμενες(εργασία_καθυστέρηση, df)

# Προσθήκη και της ίδιας της εργασίας που καθυστερεί
επηρεαζόμενες_εργασίες.append(εργασία_καθυστέρηση)

# 📌 Ενημέρωση ημερομηνιών
for εργασία in επηρεαζόμενες_εργασίες:
    df.loc[df["Εργασία"] == εργασία, "Ημερομηνία Έναρξης"] += pd.Timedelta(days=καθυστέρηση_ημέρες)
    df.loc[df["Εργασία"] == εργασία, "Ημερομηνία Λήξης"] += pd.Timedelta(days=καθυστέρηση_ημέρες)

# 📊 Εμφάνιση νέου προγράμματος
print("Νέο Πρόγραμμα:")
print(df)

# 📂 Αποθήκευση νέου Excel
df.to_excel("ΝέεςΗμερομηνίες.xlsx", index=False)
print("\nΤο νέο πρόγραμμα αποθηκεύτηκε στο 'ΝέεςΗμερομηνίες.xlsx'")
